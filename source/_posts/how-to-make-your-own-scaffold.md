---
title: ğŸ› å¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®è„šæ‰‹æ¶ï¼Ÿ
date: 2019-05-17 12:00:00
tags:
- JavaScript
- å‰ç«¯å·¥ç¨‹åŒ–
- è‡ªåŠ¨åŒ–å·¥å…·
---

![](/img/scaffold.jpg)

ç”¨è¿‡é‚£ä¹ˆå¤šè„šæ‰‹æ¶ï¼Œç°åœ¨è‡ªå·±æ¥å¼€å‘ä¸€ä¸ªå¯å¥½ï¼Ÿ

<!-- more -->

## å¼•è¨€

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨è„šæ‰‹æ¶æ¥åˆå§‹åŒ–é¡¹ç›®çš„å…¸å‹ä¾‹å­ã€‚

![](/img/how-to-make-your-own-scaffold/16ac081750971790.gif)

éšç€å‰ç«¯å·¥ç¨‹åŒ–çš„ç†å¿µä¸æ–­æ·±å…¥ï¼Œè¶Šæ¥è¶Šå¤šçš„äººé€‰æ‹©ä½¿ç”¨è„šæ‰‹æ¶æ¥ä»é›¶åˆ°ä¸€æ­å»ºè‡ªå·±çš„é¡¹ç›®ã€‚å…¶ä¸­å¤§å®¶æœ€ç†Ÿæ‚‰çš„å°±æ˜¯`create-react-app`å’Œ`vue-cli`ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–é…ç½®ã€ç”Ÿæˆé¡¹ç›®ç»“æ„ã€è‡ªåŠ¨å®‰è£…ä¾èµ–ï¼Œæœ€åæˆ‘ä»¬ä¸€è¡ŒæŒ‡ä»¤å³å¯è¿è¡Œé¡¹ç›®å¼€å§‹å¼€å‘ï¼Œæˆ–è€…è¿›è¡Œé¡¹ç›®æ„å»ºï¼ˆbuildï¼‰ã€‚

è¿™äº›è„šæ‰‹æ¶æä¾›çš„éƒ½æ˜¯æ™®éæ„ä¹‰ä¸Šçš„æœ€ä½³å®è·µï¼Œä½†æ˜¯æˆ‘åœ¨å¼€å‘ä¸­å‘ç°ï¼Œéšç€ä¸šåŠ¡çš„ä¸æ–­å‘å±•ï¼Œå¿…ç„¶ä¼šå‡ºç°éœ€è¦é’ˆå¯¹ä¸šåŠ¡å¼€å‘çš„å®é™…æƒ…å†µæ¥è¿›è¡Œè°ƒæ•´ã€‚ä¾‹å¦‚ï¼š

- é€šè¿‡è°ƒæ•´æ’ä»¶ä¸é…ç½®å®ç° Webpack æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å
- åˆ é™¤è„šæ‰‹æ¶æ„å»ºå‡ºæ¥çš„éƒ¨åˆ†åŠŸèƒ½
- é¡¹ç›®æ¶æ„è°ƒæ•´
- èåˆå…¬å¸å¼€å‘å·¥å…·
- â€¦â€¦

æ€»è€Œè¨€ä¹‹ï¼Œéšç€ä¸šåŠ¡å‘å±•ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šæ²‰æ·€å‡ºä¸€å¥—æ›´â€œä¸ªæ€§åŒ–â€çš„ä¸šåŠ¡æ–¹æ¡ˆã€‚è¿™æ—¶å€™æˆ‘ä»¬æœ€ç›´æ¥çš„åšæ³•å°±æ˜¯å¼€å‘å‡ºä¸€ä¸ªè¯¥æ–¹æ¡ˆçš„è„šæ‰‹æ¶æ¥ï¼Œä»¥ä¾¿ä»Šåèƒ½å¤ç”¨è¿™äº›æœ€ä½³å®è·µä¸æ–¹æ¡ˆã€‚

## 1. è„šæ‰‹æ¶æ€ä¹ˆå·¥ä½œï¼Ÿ

åŠŸèƒ½ä¸°å¯Œç¨‹åº¦ä¸åŒçš„è„šæ‰‹æ¶ï¼Œå¤æ‚ç¨‹åº¦è‡ªç„¶ä¹Ÿä¸å¤ªä¸€æ ·ã€‚ä½†æ˜¯æ€»ä½“æ¥è¯´ï¼Œè„šæ‰‹æ¶çš„å·¥ä½œå¤§ä½“éƒ½ä¼šåŒ…å«å‡ ä¸ªæ­¥éª¤ï¼š

- åˆå§‹åŒ–ï¼Œä¸€èˆ¬åœ¨è¿™ä¸ªæ—¶å€™ä¼šè¿›è¡Œç¯å¢ƒçš„åˆå§‹åŒ–ï¼Œåšä¸€äº›å‰ç½®çš„æ£€æŸ¥
- ç”¨æˆ·è¾“å…¥ï¼Œä¾‹å¦‚ç”¨ vue-cli çš„æ—¶å€™ï¼Œå®ƒä¼šâ€œé—®â€ä½ å¾ˆå¤šé…ç½®é€‰é¡¹
- ç”Ÿæˆé…ç½®æ–‡ä»¶
- ç”Ÿæˆé¡¹ç›®ç»“æ„ï¼Œè¿™æ˜¯å€™å¯èƒ½ä¼šä½¿ç”¨ä¸€ä¸ªé¡¹ç›®æ¨¡ç‰ˆ
- å®‰è£…ä¾èµ–
- æ¸…ç†ã€æ ¡éªŒç­‰æ”¶å°¾å·¥ä½œ

æ­¤å¤–ï¼Œä½ è¿˜éœ€è¦å¤„ç†å‘½ä»¤è¡Œè¡Œä¸ºç­‰ã€‚å¾€å¾€æˆ‘ä»¬åªæ˜¯æƒ³è½»é‡çº§ã€å¿«é€Ÿå¾—åˆ›å»ºä¸€ä¸ªç‰¹å®šåœºæ™¯çš„è„šæ‰‹æ¶ï¼ˆä¸ç”¨æƒ³vue-clié‚£ä¹ˆå®Œå¤‡ï¼‰ã€‚è€Œå¯¹äºæƒ³è¦å¿«é€Ÿåˆ›å»ºä¸€ä¸ªè„šæ‰‹æ¶ï¼Œå…¶å®æˆ‘ä»¬ä¸ç”¨å®Œå…¨ä»é›¶å¼€å§‹ã€‚[Yeoman](https://yeoman.io/) å°±æ˜¯ä¸€ä¸ªå¯ä»¥å¸®æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºè„šæ‰‹æ¶çš„å·¥å…·ã€‚

![](/img/how-to-make-your-own-scaffold/16ac137b8509c628.png)

å¯èƒ½å¾ˆå¤šåŒå­¦éƒ½ä¸å¤ªäº†è§£ï¼Œé‚£ä¹ˆå…ˆç®€å•ä»‹ç»ä¸€ä¸‹ Yeoman æ˜¯ä»€ä¹ˆï¼Œåˆæ˜¯å¦‚ä½•å¸®æˆ‘ä»¬æ¥ç®€åŒ–è„šæ‰‹æ¶æ­å»ºçš„ã€‚

é¦–å…ˆï¼ŒYeoman å¯ä»¥ç®€å•ç†è§£ä¸ºæ˜¯ä¸€ä¸ªè„šæ‰‹æ¶çš„è¿è¡Œæ¡†æ¶ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªè„šæ‰‹æ¶åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰€è¦ç»å†çš„å„ä¸ªé˜¶æ®µï¼ˆä¾‹å¦‚æˆ‘ä»¬ä¸Šé¢è¯´çš„ï¼Œå¯èƒ½ä¼šå…ˆè¯»å–ç”¨æˆ·è¾“å…¥ï¼Œç„¶åç”Ÿæˆé¡¹ç›®æ–‡ä»¶ï¼Œæœ€åå®‰è£…ä¾èµ–ï¼‰ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸçš„å¯¹åº”é˜¶æ®µï¼Œå¡«å……å¯¹åº”çš„æ“ä½œä»£ç å³å¯ã€‚è€Œæˆ‘ä»¬å¡«å……ä»£ç çš„åœ°æ–¹ï¼Œåœ¨ Yeoman ä¸­å«åš generatorï¼Œç‰©å¦‚å…¶åï¼ŒYeoman é€šè¿‡è°ƒç”¨æŸä¸ª generator å³å¯ç”Ÿæˆï¼ˆgenerateï¼‰å¯¹åº”çš„é¡¹ç›®ã€‚

å¦‚æœä½ è¿˜ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œé‚£ä¹ˆå¯ä»¥ä¸¾ä¸ªå°ä¾‹å­ï¼š

å°†è„šæ‰‹æ¶å¼€å‘ç±»æ¯”ä¸ºå‰ç«¯ç»„ä»¶å¼€å‘ï¼ŒYeoman çš„è§’è‰²å°±åƒæ˜¯ Reactï¼Œæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå°¤å…¶æ˜¯å®šä¹‰äº†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼›è€Œ generator ç±»ä¼¼äºä½ å†™çš„ä¸€ä¸ª React ä¸šåŠ¡ç»„ä»¶ï¼Œæ ¹æ® React çš„è§„åˆ™åœ¨å„ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¡«ä»£ç å³å¯ã€‚

[Yeoman å†…ç½®çš„â€œç”Ÿå‘½å‘¨æœŸâ€æ–¹æ³•æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š](https://yeoman.io/authoring/running-context.html#the-run-loop)

1. initializing
2. prompting
3. default
4. writing
5. conflicts
6. install
7. end

å…¶ä¸­ default é˜¶æ®µä¼šæ‰§è¡Œä½ è‡ªå®šä¹‰åœ°å„ç§æ–¹æ³•ã€‚

åŒæ—¶ï¼ŒYeoman è¿˜é›†æˆäº†è„šæ‰‹æ¶å¼€å‘ä¸­å¸¸ç”¨çš„å„ç±»å·¥å…·ï¼Œåƒæ˜¯æ–‡ä»¶æ“ä½œã€æ¨¡ç‰ˆå¡«å……ã€ç»ˆç«¯ä¸Šçš„ç”¨æˆ·äº¤äº’åŠŸèƒ½ï¼Œå‘½ä»¤è¡Œç­‰ï¼Œå¹¶ä¸”å°è£…æˆäº†ç®€å•æ˜“ç”¨çš„æ–¹æ³•ã€‚

é€šè¿‡è¿™ä¸¤ç‚¹ï¼ŒYeoman å¯ä»¥å¸®æˆ‘ä»¬å¤§å¤§è§„èŒƒä¸ç®€åŒ–è„šæ‰‹æ¶çš„å¼€å‘ã€‚

## 2. å¼€å‘ä¸€ä¸ªè‡ªå·±çš„è„šæ‰‹æ¶

äº†è§£äº†ä¸€äº›è„šæ‰‹æ¶çš„å·¥ä½œæ–¹å¼ä¸ Yeoman çš„åŸºæœ¬æ¦‚å¿µï¼Œå’±ä»¬å°±å¯ä»¥æ¥åˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„è„šæ‰‹æ¶ã€‚ä½œä¸ºä¾‹å­ï¼Œè¿™ä¸ªè„šæ‰‹æ¶çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå®ƒä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæœ€ç®€ç‰ˆçš„åŸºäº Webpack çš„å‰ç«¯é¡¹ç›®ã€‚æœ€ç»ˆè„šæ‰‹æ¶ä½¿ç”¨æ•ˆæœå¦‚ä¸‹ï¼š

![](/img/how-to-make-your-own-scaffold/16ac081750971790.gif)

### 2.1. å‡†å¤‡ä¸€ä¸ªé¡¹ç›®æ¨¡ç‰ˆ

è„šæ‰‹æ¶æ˜¯å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿç”Ÿæˆä¸€å¥—æ—¢å®šçš„é¡¹ç›®æ¶æ„ã€æ–‡ä»¶ã€é…ç½®ï¼Œè€Œæœ€å¸¸è§çš„åšæ³•çš„å°±æ˜¯å…ˆå†™å¥½ä¸€å¥—é¡¹ç›®æ¡†æ¶æ¨¡ç‰ˆï¼Œç­‰åˆ°è„šæ‰‹æ¶è¦ç”Ÿæˆé¡¹ç›®æ—¶ï¼Œåˆ™å°†è¿™å¥—æ¨¡ç‰ˆæ‹·è´åˆ°ç›®æ ‡ç›®å½•ä¸‹ã€‚è¿™é‡Œå…¶å®ä¼šæœ‰ä¸¤ä¸ªå°ç‚¹éœ€è¦å…³æ³¨ã€‚

ç¬¬ä¸€ä¸ªæ˜¯æ¨¡ç‰ˆå†…å˜é‡çš„å¡«å……ã€‚

åœ¨æ¨¡ç‰ˆä¸­çš„æŸäº›æ–‡ä»¶å†…å®¹å¯èƒ½ä¼šéœ€è¦ç”Ÿæˆæ—¶åŠ¨æ€æ›¿æ¢ï¼Œä¾‹å¦‚æ ¹æ®ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­è¾“å…¥çš„å†…å®¹ï¼ŒåŠ¨æ€å¡«å……`package.json`ä¸­çš„`name`å€¼ã€‚è€Œ Yeoman å†…ç½®äº† [ejs](https://github.com/mde/ejs) ä½œä¸ºæ¨¡ç‰ˆå¼•æ“ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

ç¬¬äºŒä¸ªå°±æ˜¯æ¨¡ç‰ˆçš„æ”¾ç½®ä½ç½®ã€‚

ä¸€ç§æ˜¯ç›´æ¥æ”¾åœ¨æœ¬åœ°ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æ”¾åˆ° generator ä¸­ï¼Œè·Ÿéš generator ä¸€èµ·ä¸‹è½½ï¼Œæ¯æ¬¡å®‰è£…éƒ½æ˜¯æœ¬åœ°æ‹·è´ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä½†æ˜¯é¡¹ç›®æ¨¡ç‰ˆè‡ªèº«çš„æ›´æ–°å‡çº§æ¯”è¾ƒå›°éš¾ï¼Œéœ€è¦æç¤ºç”¨æˆ·å‡çº§ generatorã€‚

å¦ä¸€ç§åˆ™æ˜¯å°†æ¨¡ç‰ˆæ–‡ä»¶æ”¾åˆ°æŸä¸ªæœåŠ¡å™¨ä¸Šï¼Œæ¯æ¬¡ä½¿ç”¨è„šæ‰‹æ¶åˆå§‹åŒ–æ—¶é€šè¿‡æŸä¸ªåœ°å€åŠ¨æ€ä¸‹è½½ï¼Œæƒ³è¦æ›´æ–°å‡çº§æ¨¡ç‰ˆä¼šå¾ˆæ–¹ä¾¿ï¼Œé€šå¸¸ä¼šé€‰æ‹©æ‰˜ç®¡åœ¨ github ä¸Šã€‚

å…³äºç¬¬äºŒä¸ªæ¨¡ç‰ˆæ”¾ç½®ç©¶ç«Ÿæ˜¯é€‰æ‹©åœ¨æœ¬åœ°å¥½ï¼Œè¿˜æ˜¯è¿œç«¯å¥½ï¼Œå…¶å®è¿˜æ˜¯ä¾æ®ä½ ä¸ªäººçš„ä¸šåŠ¡åœºæ™¯è€Œå®šï¼Œåœ¨ä¸åŒçš„åœºæ™¯çš„é™åˆ¶çš„éœ€æ±‚ä¸åŒï¼Œæˆ‘ä¹‹å‰æ—¢å†™è¿‡æ¨¡ç‰ˆæ”¾åœ¨æœ¬åœ°çš„è„šæ‰‹æ¶ï¼ˆå³å’Œè„šæ‰‹æ¶ä¸€èµ·é€šè¿‡ npm å®‰è£…ï¼‰ï¼Œä¹Ÿå†™è¿‡æ‰˜ç®¡åœ¨ git ä»“åº“ä¸Šçš„è¿™ç§æ–¹å¼ã€‚

å›åˆ°æˆ‘ä»¬ã€Œåˆ›å»ºä¸€ä¸ªæœ€ç®€ç‰ˆçš„åŸºäº Webpack çš„å‰ç«¯é¡¹ç›®ã€çš„ç›®æ ‡ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ª[é¡¹ç›®æ¨¡ç‰ˆ](https://github.com/alienzhou/webpack-kickoff-template)ï¼Œä¹‹åå°±ä¼šç”¨å®ƒæ¥ä½œä¸ºè„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®å†…å®¹ã€‚

### 2.2. åˆ›å»º generatorï¼ˆyeoman-generatorï¼‰

åˆ›å»º Yeoman çš„ generator éœ€è¦éµå¾ªå®ƒçš„è§„åˆ™ã€‚

é¦–å…ˆæ˜¯ generator å‘½åè§„åˆ™ã€‚éœ€è¦ä»¥`generator`æ‰“å¤´ï¼Œæ¨ªçº¿è¿æ¥ã€‚ä¾‹å¦‚ä½ æƒ³åˆ›å»ºä¸€ä¸ªåä¸º webpack-kickoff çš„ generatorï¼ŒåŒ…åéœ€è¦å–æˆ `generator-webpack-kickoff`ã€‚

è¿™æ ·ï¼Œå½“ä½ é€šè¿‡

```bash
npm i -g yo
```

å®‰è£…å®Œ Yeoman çš„ CLI åï¼Œå°±å¯ä»¥é€šè¿‡`yo`å‘½ä»¤æ¥ä½¿ç”¨ generator æ¥å¯åŠ¨è„šæ‰‹æ¶ï¼š

```
yo webpack-kickoff
```

è¿™é‡Œçš„ webpack-kickoff å°±æ˜¯åŒ…åé‡Œ`generator-`åé¢çš„å†…å®¹ï¼ŒYeoman ä¼šæŒ‰è¿™ä¸ªè§„åˆ™å»å…¨å±€æ‰¾ç›¸åŒ¹é…çš„åŒ…ã€‚

å…¶æ¬¡ï¼Œä¾æ® Yeoman çš„è§„èŒƒï¼Œé»˜è®¤æƒ…å†µä¸‹ä½ éœ€è¦åœ¨é¡¹ç›®ï¼ˆå³ generatorï¼‰çš„`generators/app/`ç›®å½•ä¸‹åˆ›å»º`index.js`ï¼Œåœ¨å…¶ä¸­å†™å…¥ä½ çš„è„šæ‰‹æ¶å·¥ä½œæµç¨‹ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡[ä¿®æ”¹é…ç½®æ¥æ‰©å±•æˆ–æ”¹å˜è¿™ä¸ªè§„åˆ™](https://yeoman.io/authoring/index.html#folder-tree)ã€‚

æ­¤å¤–ï¼Œä½ åˆ›å»ºçš„ generator ç±»éœ€è¦ç»§æ‰¿ yeoman-generatorã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šåœ¨`generators/app/index.js`ä¸­å†™å¦‚ä¸‹ä»£ç ï¼š

```JavaScript
const Generator = require('yeoman-generator');
class WebpackKickoffGenerator extends Generator {
    constructor(params, opts) {
        super(params, opts);
    }
}
module.exports = WebpackKickoffGenerator;
```

è¿˜è®°å¾—ä¹‹å‰æåˆ°çš„â€œç”Ÿå‘½å‘¨æœŸâ€æ–¹æ³•ä¹ˆï¼ŸåŒ…æ‹¬ initializingã€promptingã€defaultã€writingã€conflictsã€install å’Œ endã€‚é™¤äº†`default`ï¼Œå…¶ä»–éƒ½ä»£è¡¨äº† Generator ä¸­çš„ä¸€ä¸ªåŒåæ–¹æ³•ï¼Œä½ éœ€è¦çš„å°±æ˜¯åœ¨å­ç±»ä¸­é‡å†™åæ‰€éœ€çš„å¯¹åº”æ–¹æ³•ã€‚`default`é˜¶æ®µåˆ™ä¼šæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„ç±»æ–¹æ³•ã€‚

ä¾‹å¦‚ï¼Œä½ æƒ³åœ¨åˆå§‹åŒ–æ—¶æ‰“å°ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š

```JavaScript
const Generator = require('yeoman-generator');
class WebpackKickoffGenerator extends Generator {
    constructor(params, opts) {
        super(params, opts);
    }
    
    initializing() {
        const version = require('../../package.json').version;
        this.log(version);
    }
}
module.exports = WebpackKickoffGenerator;
```

å¯è§ï¼Œå‰©ä¸‹çš„å·¥ä½œå°±æ˜¯åœ¨ WebpackKickoffGenerator ç±»ä¸­å¡«å……å„ç§æ–¹æ³•çš„å®ç°ç»†èŠ‚äº†ã€‚

### 2.3. å¤„ç†ç”¨æˆ·äº¤äº’

è„šæ‰‹æ¶å·¥ä½œä¸­ä¸€èˆ¬éƒ½ä¼šæœ‰ä¸€äº›ç”¨æˆ·è‡ªå®šä¹‰çš„å†…å®¹ï¼Œä¾‹å¦‚åˆ›å»ºçš„é¡¹ç›®ç›®å½•åï¼Œæˆ–è€…æ˜¯å¦å¯ç”¨æŸä¸ªé…ç½®ç­‰ã€‚è¿™äº›äº¤äº’ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡äº¤äº’å¼çš„ç»ˆç«¯æ¥å®ç°çš„ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªåŠŸèƒ½ã€‚

![](/img/how-to-make-your-own-scaffold/16ac080688a52242.png)

å¯ä»¥ä½¿ç”¨ [Inquirer.js](https://github.com/SBoudrias/Inquirer.js) æ¥å®ç°ã€‚è€Œ Yeoman å·²ç»å¸®æˆ‘ä»¬é›†æˆå¥½äº†ï¼Œç›´æ¥åœ¨ generator é‡Œè°ƒç”¨ `this.prompt` å³å¯ã€‚

åœ¨ç”¨æˆ·äº¤äº’éƒ¨åˆ†çš„éœ€æ±‚ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦è¯¢é—®ç”¨æˆ·æ‰€éœ€åˆ›å»ºçš„é¡¹ç›®ç›®å½•åå³å¯ï¼Œéšåä¹Ÿä¼šä½œä¸ºé¡¹ç›®åã€‚æŒ‰ç…§ Yeoman çš„æµç¨‹è§„èŒƒï¼Œæˆ‘ä»¬å°†è¯¥éƒ¨åˆ†ä»£ç å†™åœ¨ `prompting` æ–¹æ³•ä¸­ï¼š

```JavaScript
class WebpackKickoffGenerator extends Generator {
    // â€¦â€¦
    prompting() {
        const done = this.async();

        const opts = [{
            type: 'input',
            name: 'dirName',
            message: 'Please enter the directory name for your projectï¼š',
            default: 'webpack-app',
            validate: dirName => {
                if (dirName.length < 1) {
                    return 'âš ï¸  directory name must not be nullï¼';
                }
                return true;
            }
        }];

        return this.prompt(opts).then(({dirName}) => {
            this.dirName = dirName;
            done();
        });
    }
    // â€¦â€¦
}
```

æ³¨æ„ï¼Œç”±äºç”¨æˆ·äº¤äº’æ˜¯ä¸€ä¸ªâ€œå¼‚æ­¥â€çš„è¡Œä¸ºï¼Œä¸ºäº†è®©åç»­ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨â€œå¼‚æ­¥â€å®Œæˆåå†ç»§ç»­æ‰§è¡Œï¼Œéœ€è¦è°ƒç”¨`this.async()`æ–¹æ³•æ¥é€šçŸ¥æ–¹æ³•ä¸ºå¼‚æ­¥æ–¹æ³•ï¼Œé¿å…é¡ºåºæ‰§è¡Œå®ŒåŒæ­¥ä»£ç åç›´æ¥è°ƒç”¨ä¸‹ä¸€é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚è°ƒç”¨åä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œå‡½æ•°è¡¨æ˜è¯¥é˜¶æ®µå®Œæˆã€‚

### 2.4. ä¸‹è½½æ¨¡ç‰ˆ

æ­£å¦‚2.1.ä¸­æ‰€è¿°ï¼Œæˆ‘ä»¬é€‰æ‹©å°†æ¨¡ç‰ˆæ‰˜ç®¡åœ¨ [github](https://github.com/alienzhou/webpack-kickoff-template) ä¸Šï¼Œå› æ­¤åœ¨ç”Ÿæˆå…·ä½“é¡¹ç›®ä»£ç å‰ï¼Œéœ€è¦å°†ç›¸åº”çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚å¯ä»¥ä½¿ç”¨ [download-git-repo](https://github.com/flipxfx/download-git-repo) æ¥å¿«é€Ÿå®ç°ã€‚

```JavaScript
class WebpackKickoffGenerator extends Generator {
    // â€¦â€¦
    _downloadTemplate() {
        return new Promise((resolve, reject) => {
            const dirPath = this.destinationPath(this.dirName, '.tmp');
            download('alienzhou/webpack-kickoff-template', dirPath, err => {
                if (err) {
                    reject(err);
                    return;
                }
                resolve();
            });
        });
    }
    // â€¦â€¦
}
```

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†`this.destinationPath()`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦ç”¨äºè·å–è·¯å¾„ã€‚ä¸ä¼ å‚æ—¶è¿”å›å½“å‰å‘½ä»¤è¡Œè¿è¡Œçš„ç›®å½•ï¼›å¦‚æœæ”¶åˆ°å¤šä¸ªå‚æ•°ï¼Œåˆ™ä¼šè¿›è¡Œè·¯å¾„çš„æ‹¼æ¥ã€‚

æ­¤å¤–ï¼Œå¦‚æœä½ ç»†å¿ƒçš„è¯ï¼Œä¼šå‘ç°`_downloadTemplate()`æ–¹æ³•å¸¦äº†ä¸€ä¸ªä¸‹åˆ’çº¿å‰ç¼€ã€‚è¿™æ˜¯ Yeoman ä¸­çš„ä¸€ä¸ªçº¦å®šï¼šYeoman æ‰§è¡Œé¡ºåºä¸­æœ‰ä¸ª`default`é˜¶æ®µï¼Œè¯¥é˜¶æ®µåŒ…å«äº†æ‰€æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æœæŸäº›æ–¹æ³•ä½ ä¸å¸Œæœ›è¢« Yeoman çš„è„šæ‰‹æ¶æµç¨‹ç›´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯ä½œä¸ºå·¥å…·æ–¹æ³•æä¾›ç»™å…¶ä»–ç±»æ–¹æ³•ï¼Œåˆ™å¯ä»¥æ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿å‰ç¼€ã€‚å¯¹äºè¿™ç§å‘½åçš„æ–¹æ³•ï¼Œåˆ™ä¼šåœ¨`default`é˜¶æ®µè¢«å¿½ç•¥ã€‚

### 2.5. æ¨¡ç‰ˆæ–‡ä»¶æ‹·è´

é¡¹ç›®æ¨¡ç‰ˆä¸‹è½½å®Œæ¯•åï¼Œä¸‹é¢å°±å¯ä»¥å°†ç›¸å…³çš„ç›®å½•ã€æ–‡ä»¶æ‹·è´åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›éƒ½å¯ä»¥åœ¨`writing`é˜¶æ®µæ“ä½œã€‚æ­¤æ—¶éœ€è¦éå†æ¨¡ç‰ˆä¸­çš„æ‰€æœ‰ç›®å½•ï¼Œå°†æ‰€æœ‰æ–‡ä»¶è¿›è¡Œæ¨¡ç‰ˆå¡«å……ä¸æ‹·è´ã€‚éå†æ–¹å¼å¦‚ä¸‹ï¼š

```JavaScript
class WebpackKickoffGenerator extends Generator {
    // â€¦â€¦
    _walk(filePath, templateRoot) {
        if (fs.statSync(filePath).isDirectory()) {
            fs.readdirSync(filePath).forEach(name => {
                this._walk(path.resolve(filePath, name), templateRoot);
            });
            return;
        }

        const relativePath = path.relative(templateRoot, filePath);
        const destination = this.destinationPath(this.dirName, relativePath);
        this.fs.copyTpl(filePath, destination, {
            dirName: this.dirName
        });
    }
    // â€¦â€¦
}
```

è¿™é‡Œä½¿ç”¨äº†`this.fs.copyTpl()`æ–¹æ³•ï¼Œå®ƒæ”¯æŒæ–‡ä»¶æ‹·è´ï¼ŒåŒæ—¶è¿˜å¯ä»¥æŒ‡å®šç›¸åº”çš„æ¨¡ç‰ˆå‚æ•°ï¼Œæ­¤å¤–ï¼Œå¦‚æœå‡ºç°é‡åè¦†ç›–æƒ…å†µä¼šåœ¨æ§åˆ¶å°è‡ªåŠ¨è¾“å‡ºç›¸åº”ä¿¡æ¯ã€‚

æœ€åï¼ŒæŠŠä¸‹è½½ä¸æ‹·è´æ•´åˆèµ·æ¥å³å¯å®Œæˆ`writing`é˜¶æ®µã€‚

```JavaScript
class WebpackKickoffGenerator extends Generator {
    // â€¦â€¦
    writing() {
        const done = this.async();
        this._downloadTemplate()
            .then(() => {
                const templateRoot = this.destinationPath(this.dirName, '.tmp');
                this._walk(templateRoot, templateRoot);
                fs.removeSync(templateRoot);
                done();
            })
            .catch(err => {
                this.env.error(err);
            });
    }
    // â€¦â€¦
}
```

### 2.6. ä¾èµ–å®‰è£…

åˆ°ç›®å‰ï¼Œè„šæ‰‹æ¶å·²ç»å¯ä»¥å¸®æˆ‘ä»¬æŠŠé¡¹ç›®å¼€å‘æ‰€éœ€çš„é…ç½®ã€ç›®å½•ç»“æ„ã€ä¾èµ–æ¸…å•éƒ½å‡†å¤‡å¥½äº†ã€‚è¿™æ—¶å€™å¯ä»¥è¿›ä¸€æ­¥å¸®å¼€å‘äººå‘˜å°†ä¾èµ–å®‰è£…å®Œæ¯•ï¼Œè¿™æ ·è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®å®Œæˆåï¼Œå¼€å‘äººå‘˜å°±å¯ä»¥ç›´æ¥å¼€å‘äº†ã€‚

Yeoman ä¹Ÿæä¾›äº†`this.npmInstall()`æ¥æ–¹æ³•æ¥å®ç° npm åŒ…çš„å®‰è£…ï¼š

```JavaScript
class WebpackKickoffGenerator extends Generator {
    // â€¦â€¦
    install() {
        this.npmInstall('', {}, {
            cwd: this.destinationPath(this.dirName)
        });
    }
    // â€¦â€¦
}
```

åˆ°è¿™é‡Œï¼Œè„šæ‰‹æ¶çš„æ ¸å¿ƒåŠŸèƒ½å°±å®Œæˆäº†ã€‚å·²ç»å¯ä»¥ä½¿ç”¨å’±ä»¬çš„è¿™ä¸ª generator æ¥å¿«é€Ÿåˆ›å»ºé¡¹ç›®äº†ã€‚å¾ˆç®€å•å§~

> å®Œæ•´çš„ä»£ç å¯ä»¥å‚è€ƒ [generator-webpack-kickoff](https://github.com/alienzhou/generator-webpack-kickoff)ã€‚

## 3. ä½¿ç”¨è„šæ‰‹æ¶ ğŸš€

ä½¿ç”¨è¯¥è„šæ‰‹æ¶ä¼šåŒæ—¶éœ€è¦ Yeoman ä¸ä¸Šè¿°å’±ä»¬åˆšåˆ›å»ºçš„ yeoman-generatorã€‚å½“ç„¶ï¼Œæœ‰ä¸€ä¸ªå‰æï¼ŒYeoman ä¸è¿™ä¸ª generator éƒ½éœ€è¦å…¨å±€å®‰è£…ã€‚å…¨å±€å®‰è£… Yeoman æ²¡å•¥æœ‰é—®é¢˜ï¼ˆ`npm install -g yo`ï¼‰ï¼Œå¤„ç† generator-webpack-kickoff çš„è¯å¯èƒ½æœ‰å‡ ç§æ–¹å¼ï¼š

1. ç›´æ¥å‘å¸ƒåˆ° npmï¼Œç„¶åæ­£å¸¸å…¨å±€å®‰è£…
2. ç›´æ¥æ‰‹åŠ¨æ‹·è´åˆ°å…¨å±€ node_modules
3. ä½¿ç”¨`npm link`å°†æŸä¸ªç›®å½•é“¾æ¥åˆ°å…¨å±€

ä¾æ®2.2.èŠ‚çš„å†…å®¹ï¼Œå’±ä»¬çš„ generator åç§°ä¸º generator-webpack-kickoffã€‚ç”±äºæˆ‘çš„åŒ…å·²ç»å‘åˆ° npm ä¸Šäº†ï¼Œæ‰€ä»¥è¦ä½¿ç”¨è¯¥è„šæ‰‹æ¶å¯ä»¥è¿è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š

```bash
# å®‰è£…ä¸€æ¬¡å³å¯
npm i -g yo
npm i -g generator-webpack-kickoff

# å¯åŠ¨è„šæ‰‹æ¶
yo webpack-kickoff
```

## 4. ä¼˜åŒ–

ä»ä¸Šæ–‡è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå®ç°ä¸€ä¸ªè„šæ‰‹æ¶éå¸¸ç®€å•ã€‚ä¾‹å­è™½å°ï¼Œä½†ä¹ŸåŒ…å«äº†è„šæ‰‹æ¶å¼€å‘çš„ä¸»è¦éƒ¨åˆ†ã€‚å½“ç„¶ï¼Œè¿™ç¯‡æ–‡ç« ä¸ºäº†ç®€åŒ–ï¼Œçœç•¥äº†ä¸€äº›â€œä¼˜åŒ–â€åŠŸèƒ½ã€‚ä¾‹å¦‚

- é¡¹ç›®ç›®å½•çš„é‡åæ£€æµ‹ï¼Œç”Ÿæˆé¡¹ç›®æ—¶ï¼Œæ£€æŸ¥æ˜¯å¦ç›®å½•å·²å­˜åœ¨ï¼Œå¹¶æç¤ºè­¦å‘Š
- é¡¹ç›®æ¨¡ç‰ˆçš„ç¼“å­˜ã€‚è™½ç„¶æˆ‘ä»¬ä½¿ç”¨ github æ‰˜ç®¡æ–¹å¼ï¼Œä½†ä¹Ÿå¯ä»¥è€ƒè™‘ä¸å¿…æ¯æ¬¡éƒ½é‡æ–°ä¸‹è½½ï¼Œå¯ä»¥æ”¾ä¸€ä»½æœ¬åœ°ç¼“å­˜ï¼Œç„¶åæ¯å¤©æˆ–æ¯å‘¨æ›´æ–°ï¼›
- CLI çš„ä¼˜åŒ–ã€‚[å®Œæ•´ç‰ˆ](https://github.com/alienzhou/generator-webpack-kickoff)é‡Œè¿˜ä¼šåŒ…å«ä¸€äº›æ›´ä¸°å¯Œçš„ CLI ä½¿ç”¨ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨åŠ¨å›¾ä¸­çœ‹åˆ°çš„ loading æ•ˆæœã€å¤´å°¾æ˜¾ç¤ºçš„ä¿¡æ¯é¢æ¿ç­‰ã€‚è¿™äº›å·¥å…·åŒ…æ‹¬
    - [ora](https://github.com/sindresorhus/ora)ï¼Œç”¨äºåˆ›å»º spinnerï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ loading æ•ˆæœ
    - [chalk](https://github.com/chalk/chalk)ï¼Œç”¨äºæ‰“å°å½©è‰²çš„ä¿¡æ¯
    - [update-notifier](https://github.com/yeoman/update-notifier)ï¼Œç”¨äºæ£€æŸ¥åŒ…çš„çº¿ä¸Šç‰ˆæœ¬ä¸æœ¬åœ°ç‰ˆæœ¬
    - [beeper](https://github.com/sindresorhus/beeper)ï¼Œå¯ä»¥â€œå“”â€ä¸€ä¸‹ä½ ï¼Œä¾‹å¦‚å‡ºé”™çš„æ—¶å€™
    - [boxen](https://github.com/sindresorhus/boxen)ï¼Œåˆ›å»ºå¤´å°¾çš„é‚£ä¸ªå°â€œé¢æ¿â€
- ç‰ˆæœ¬æ£€æŸ¥ã€‚ä¸Šé¢æåˆ°å¯ä»¥ç”¨ [update-notifier](https://github.com/yeoman/update-notifier) æ¥æ£€æŸ¥ç‰ˆæœ¬ã€‚æ‰€ä»¥å¯ä»¥åœ¨ initializing é˜¶æ®µè¿›è¡Œç‰ˆæœ¬æ£€æŸ¥ï¼Œæç¤ºç”¨æˆ·æ›´æ–°è„šæ‰‹æ¶ã€‚

## æœ€å

æœ¬æ–‡é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å‘Šè¯‰å¤§å®¶å¦‚ä½•ä½¿ç”¨ Yeoman å¿«é€Ÿåˆ›å»ºè„šæ‰‹æ¶ã€‚è¦äº†è§£æ›´å¤š yeoman-generator çš„å¼€å‘ä¸ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ[ç¤¾åŒºé‡Œå¤§å®¶å†™çš„å„ç±» generator](https://www.npmjs.com/search?q=keywords:yeoman-generator)ã€‚ç›®å‰åœ¨ npm ä¸Šæœ‰è¶…è¿‡ 8000 ä¸ª yeoman-generatorï¼Œä¹Ÿè®¸å°±ä¼šæœ‰ä½ çš„èœã€‚

> æ–‡ä¸­å®Œæˆçš„ä»£ç è¯·æŸ¥çœ‹ [generator-webpack-kickoff](https://github.com/alienzhou/generator-webpack-kickoff)ã€‚